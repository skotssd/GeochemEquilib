["% setup environment\n% set path to equilibrium solver\ntxt=pwd;\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-19);\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% setup environment\n% set path to equilibrium solver\ntxt=pwd;\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-18);\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% MODEL USING PHREEQC\n\nminerals=[{'AgCls'}]; totalvector=[AgT; ClT; ClT]; totalnames=[{'Ag'}; {'Cl'}; {'Na'}]; speciesexport=[{'Ag+'}; {'Cl-'}];\n%database=['llnl_nosolubleAgCl.dat']; \nacid=['NaOH']; show=0; T=25;\n%database=['AgCl.dat']; \ndatabase=['simplestAgCl.dat']; \n\ntic\n[solutionspeciesconcs, speciesnames, solidconcs, solidnames]=runPHREEQCv2noHA(T,pH,pe,totalnames,totalvector,minerals,speciesexport,database,show,acid);\nPHREEQCtime=toc;\n\nAgPHREEQC=solutionspeciesconcs(1); ClPHREEQC=solutionspeciesconcs(2); AgClsPHREEQC=solidconcs(1);\nAgmasserrorPHREEQC=AgT-AgPHREEQC-AgClsPHREEQC; ClmasserrorPHREEQC=ClT-ClPHREEQC-AgClsPHREEQC;", "% exact model\n\nKsp=10^-9.7453;\n\n% check SI\n\nIAP=AgT*ClT;\n\nAgexact=AgT; Clexact=ClT; AgClsexact=0;\n\nif IAP>=Ksp\na=1; b=ClT-AgT; c=-Ksp;\nt=roots([a b c]); t=t(t>0); t=real(t(imag(t)==0));\nAgexact=t; AgClsexact=AgT-Ag; Clexact=ClT-AgClsexact;\nend", "% setup environment\n% set path to equilibrium solver\ntxt=pwd;\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-18);\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% setup environment\n% set path to equilibrium solver\ntxt=pwd;\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-18);\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% MODEL USING PHREEQC\n\nminerals=[{'AgCls'}]; totalvector=[AgT; ClT; ClT]; totalnames=[{'Ag'}; {'Cl'}; {'Na'}]; speciesexport=[{'Ag+'}; {'Cl-'}];\n%database=['llnl_nosolubleAgCl.dat']; \nacid=['NaOH']; show=0; T=25;\n%database=['AgCl.dat']; \ndatabase=['simplestAgCl.dat']; \n\ntic\n[solutionspeciesconcs, speciesnames, solidconcs, solidnames]=runPHREEQCv2noHA(T,pH,pe,totalnames,totalvector,minerals,speciesexport,database,show,acid);\nPHREEQCtime=toc;\n\nAgPHREEQC=solutionspeciesconcs(1); ClPHREEQC=solutionspeciesconcs(2); AgClsPHREEQC=solidconcs(1);\nAgmasserrorPHREEQC=AgT-AgPHREEQC-AgClsPHREEQC; ClmasserrorPHREEQC=ClT-ClPHREEQC-AgClsPHREEQC;", "% exact model\n\nKsp=10^-9.7453;\n\n% check SI\n\nIAP=AgT*ClT;\n\nAgexact=AgT; Clexact=ClT; AgClsexact=0;\n\nif IAP>=Ksp\na=1; b=ClT-AgT; c=-Ksp;\nt=roots([a b c]); t=t(t>0); t=real(t(imag(t)==0));\nAgexact=t; AgClsexact=AgT-Ag; Clexact=ClT-AgClsexact;\nend", "% compare models\n\nAgcompare=[Ag AgPHREEQC Agexact]\nClcompare=[Cl ClPHREEQC Clexact]\nAgClcompare=[AgCls AgClsPHREEQC AgClsexact]\nAgmasserrorcompare=[Agmasserror AgmasserrorPHREEQC]\nClmasserrorcompare=[Clmasserror ClmasserrorPHREEQC]\ntimecompare=[tableautime PHREEQCtime]", "% setup environment\n% set path to equilibrium solver\ntxt=pwd;\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-18);\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% MODEL USING PHREEQC\n\nminerals=[{'AgCls'}]; totalvector=[AgT; ClT; ClT]; totalnames=[{'Ag'}; {'Cl'}; {'Na'}]; speciesexport=[{'Ag+'}; {'Cl-'}];\n%database=['llnl_nosolubleAgCl.dat']; \nacid=['NaOH']; show=0; T=25;\n%database=['AgCl.dat']; \ndatabase=['simplestAgCl.dat']; \n\ntic\n[solutionspeciesconcs, speciesnames, solidconcs, solidnames]=runPHREEQCv2noHA(T,pH,pe,totalnames,totalvector,minerals,speciesexport,database,show,acid);\nPHREEQCtime=toc;\n\nAgPHREEQC=solutionspeciesconcs(1); ClPHREEQC=solutionspeciesconcs(2); AgClsPHREEQC=solidconcs(1);\nAgmasserrorPHREEQC=AgT-AgPHREEQC-AgClsPHREEQC; ClmasserrorPHREEQC=ClT-ClPHREEQC-AgClsPHREEQC;", "% exact model\n\nKsp=10^-9.7453;\n\n% check SI\n\nIAP=AgT*ClT;\n\nAgexact=AgT; Clexact=ClT; AgClsexact=0;\n\nif IAP>=Ksp\na=1; b=ClT-AgT; c=-Ksp;\nt=roots([a b c]); t=t(t>0); t=real(t(imag(t)==0));\nAgexact=t; AgClsexact=AgT-Ag; Clexact=ClT-AgClsexact;\nend", "% compare models\n\nAgcompare=[Ag AgPHREEQC Agexact]\nClcompare=[Cl ClPHREEQC Clexact]\nAgClcompare=[AgCls AgClsPHREEQC AgClsexact]\nAgmasserrorcompare=[Agmasserror AgmasserrorPHREEQC]\nClmasserrorcompare=[Clmasserror ClmasserrorPHREEQC]\ntimecompare=[tableautime PHREEQCtime]", "% setup environment\n% set path to equilibrium solver\ntxt=pwd;\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-18);\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% MODEL USING PHREEQC\n\nminerals=[{'AgCls'}]; totalvector=[AgT; ClT; ClT]; totalnames=[{'Ag'}; {'Cl'}; {'Na'}]; speciesexport=[{'Ag+'}; {'Cl-'}];\n%database=['llnl_nosolubleAgCl.dat']; \nacid=['NaOH']; show=0; T=25;\n%database=['AgCl.dat']; \ndatabase=['simplestAgCl.dat']; \n\ntic\n[solutionspeciesconcs, speciesnames, solidconcs, solidnames]=runPHREEQCv2noHA(T,pH,pe,totalnames,totalvector,minerals,speciesexport,database,show,acid);\nPHREEQCtime=toc;\n\nAgPHREEQC=solutionspeciesconcs(1); ClPHREEQC=solutionspeciesconcs(2); AgClsPHREEQC=solidconcs(1);\nAgmasserrorPHREEQC=AgT-AgPHREEQC-AgClsPHREEQC; ClmasserrorPHREEQC=ClT-ClPHREEQC-AgClsPHREEQC;", "% exact model\n\nKsp=10^-9.7453;\n\n% check SI\n\nIAP=AgT*ClT;\n\nAgexact=AgT; Clexact=ClT; AgClsexact=0;\n\nif IAP>=Ksp\na=1; b=ClT-AgT; c=-Ksp;\nt=roots([a b c]); t=t(t>0); t=real(t(imag(t)==0));\nAgexact=t; AgClsexact=AgT-Ag; Clexact=ClT-AgClsexact;\nend", "% compare models\n\nAgcompare=[Ag AgPHREEQC Agexact]\nClcompare=[Cl ClPHREEQC Clexact]\nAgClcompare=[AgCls AgClsPHREEQC AgClsexact]\nAgmasserrorcompare=[Agmasserror AgmasserrorPHREEQC]\nClmasserrorcompare=[Clmasserror ClmasserrorPHREEQC]\ntimecompare=[tableautime PHREEQCtime]", "% setup environment\n% set path to equilibrium solver\ntxt=pwd;\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-18)\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% setup environment\n% set path to equilibrium solver\ntxt=pwd\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-18)\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% setup environment\n% set path to equilibrium solver\ntxt=pwd\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-4)\nPHREEQCpath=[rootpath,'/runPHREEQC'];\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB'];\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% MODEL USING PHREEQC\n\nminerals=[{'AgCls'}]; totalvector=[AgT; ClT; ClT]; totalnames=[{'Ag'}; {'Cl'}; {'Na'}]; speciesexport=[{'Ag+'}; {'Cl-'}];\n%database=['llnl_nosolubleAgCl.dat']; \nacid=['NaOH']; show=0; T=25;\n%database=['AgCl.dat']; \ndatabase=['simplestAgCl.dat']; \n\ntic\n[solutionspeciesconcs, speciesnames, solidconcs, solidnames]=runPHREEQCv2noHA(T,pH,pe,totalnames,totalvector,minerals,speciesexport,database,show,acid);\nPHREEQCtime=toc;\n\nAgPHREEQC=solutionspeciesconcs(1); ClPHREEQC=solutionspeciesconcs(2); AgClsPHREEQC=solidconcs(1);\nAgmasserrorPHREEQC=AgT-AgPHREEQC-AgClsPHREEQC; ClmasserrorPHREEQC=ClT-ClPHREEQC-AgClsPHREEQC;", "% exact model\n\nKsp=10^-9.7453;\n\n% check SI\n\nIAP=AgT*ClT;\n\nAgexact=AgT; Clexact=ClT; AgClsexact=0;\n\nif IAP>=Ksp\na=1; b=ClT-AgT; c=-Ksp;\nt=roots([a b c]); t=t(t>0); t=real(t(imag(t)==0));\nAgexact=t; AgClsexact=AgT-Ag; Clexact=ClT-AgClsexact;\nend", "% compare models\n\nAgcompare=[Ag AgPHREEQC Agexact]\nClcompare=[Cl ClPHREEQC Clexact]\nAgClcompare=[AgCls AgClsPHREEQC AgClsexact]\nAgmasserrorcompare=[Agmasserror AgmasserrorPHREEQC]\nClmasserrorcompare=[Clmasserror ClmasserrorPHREEQC]\ntimecompare=[tableautime PHREEQCtime]", "% setup environment\n% set path to equilibrium solver\ntxt=pwd\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-4)\nPHREEQCpath=[rootpath,'/runPHREEQC']\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB']\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% setup environment\n% set path to equilibrium solver\ntxt=pwd\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-5)\nPHREEQCpath=[rootpath,'/runPHREEQC']\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB']\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% MODEL USING PHREEQC\n\nminerals=[{'AgCls'}]; totalvector=[AgT; ClT; ClT]; totalnames=[{'Ag'}; {'Cl'}; {'Na'}]; speciesexport=[{'Ag+'}; {'Cl-'}];\n%database=['llnl_nosolubleAgCl.dat']; \nacid=['NaOH']; show=0; T=25;\n%database=['AgCl.dat']; \ndatabase=['simplestAgCl.dat']; \n\ntic\n[solutionspeciesconcs, speciesnames, solidconcs, solidnames]=runPHREEQCv2noHA(T,pH,pe,totalnames,totalvector,minerals,speciesexport,database,show,acid);\nPHREEQCtime=toc;\n\nAgPHREEQC=solutionspeciesconcs(1); ClPHREEQC=solutionspeciesconcs(2); AgClsPHREEQC=solidconcs(1);\nAgmasserrorPHREEQC=AgT-AgPHREEQC-AgClsPHREEQC; ClmasserrorPHREEQC=ClT-ClPHREEQC-AgClsPHREEQC;", "% exact model\n\nKsp=10^-9.7453;\n\n% check SI\n\nIAP=AgT*ClT;\n\nAgexact=AgT; Clexact=ClT; AgClsexact=0;\n\nif IAP>=Ksp\na=1; b=ClT-AgT; c=-Ksp;\nt=roots([a b c]); t=t(t>0); t=real(t(imag(t)==0));\nAgexact=t; AgClsexact=AgT-Ag; Clexact=ClT-AgClsexact;\nend", "% compare models\n\nAgcompare=[Ag AgPHREEQC Agexact]\nClcompare=[Cl ClPHREEQC Clexact]\nAgClcompare=[AgCls AgClsPHREEQC AgClsexact]\nAgmasserrorcompare=[Agmasserror AgmasserrorPHREEQC]\nClmasserrorcompare=[Clmasserror ClmasserrorPHREEQC]\ntimecompare=[tableautime PHREEQCtime]", "% setup environment\n% set path to equilibrium solver\ntxt=pwd\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-5)\nPHREEQCpath=[rootpath,'/runPHREEQC']\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB']\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% setup environment\n% set path to equilibrium solver\ntxt=pwd\nn=length(txt);\nrootpath=txt; rootpath=txt(1:n-11)\nPHREEQCpath=[rootpath,'/runPHREEQC']\naddpath(PHREEQCpath);\nJEQUILIBpath=[rootpath,'/JEQUILIB']\naddpath(JEQUILIBpath);\n% clear data and number format\nclear; format short e\n% turn off warnings\nwarning off\n%graphics_toolkit (\"notebook\"); \n%graphics_toolkit (\"plotly\"); \n%graphics_toolkit(\"gnuplot\")", "% MODEL USING TABLEAU (different gradients or log versus linear variables)\n%graphics_toolkit(\"notebook\")\n%model with just inorganic speciation\n%geochemical model\n% input the constants and solution chemistry\n\nflag1=1; %flag1 for concentration based search vector (1) or for log based search vector (2).\nflag2=2; %flag2 for numerical derivatives (2) or analtyical derivatives (1)\n%database=[]; \nflag3=0; % flag3 1 for show warnings. 0 no warnings\nflag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only\nflag5=0; %if=1 use stored initial guess for including solids\n\nAgT=1e-4; ClT=1e-4; pH=7; \n\nTOTALS=[AgT ClT];\nTOTALS(TOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error\n%TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;\npH=pH; pe=20.75-pH; \n\ntic;\n[Ag,Cl,AgCls,MASSERR]=AgCltableau(pH,pe,TOTALS',flag1,flag2,flag3,flag4,flag5);\ntableautime=toc;\n\nAgmasserror=MASSERR(1); Clmasserror=MASSERR(2);", "% MODEL USING PHREEQC\n\nminerals=[{'AgCls'}]; totalvector=[AgT; ClT; ClT]; totalnames=[{'Ag'}; {'Cl'}; {'Na'}]; speciesexport=[{'Ag+'}; {'Cl-'}];\n%database=['llnl_nosolubleAgCl.dat']; \nacid=['NaOH']; show=0; T=25;\n%database=['AgCl.dat']; \ndatabase=['simplestAgCl.dat']; \n\ntic\n[solutionspeciesconcs, speciesnames, solidconcs, solidnames]=runPHREEQCv2noHA(T,pH,pe,totalnames,totalvector,minerals,speciesexport,database,show,acid);\nPHREEQCtime=toc;\n\nAgPHREEQC=solutionspeciesconcs(1); ClPHREEQC=solutionspeciesconcs(2); AgClsPHREEQC=solidconcs(1);\nAgmasserrorPHREEQC=AgT-AgPHREEQC-AgClsPHREEQC; ClmasserrorPHREEQC=ClT-ClPHREEQC-AgClsPHREEQC;", "% exact model\n\nKsp=10^-9.7453;\n\n% check SI\n\nIAP=AgT*ClT;\n\nAgexact=AgT; Clexact=ClT; AgClsexact=0;\n\nif IAP>=Ksp\na=1; b=ClT-AgT; c=-Ksp;\nt=roots([a b c]); t=t(t>0); t=real(t(imag(t)==0));\nAgexact=t; AgClsexact=AgT-Ag; Clexact=ClT-AgClsexact;\nend"]