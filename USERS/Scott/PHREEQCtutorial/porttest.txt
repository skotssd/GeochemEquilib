TITLE TEST PORTLANDITE DISSOLUTION
SOLUTION 1
       pe      13.75
       pH      7
       temp    25
-units mol/kgw

RATES
Portlandite
-start
1   REM   PARM(1) = rate constant. PARM(2) Ksp for portlandite 
2 Ca=Act("Ca+2")
3 OH=Act("OH-")
4 IAP=Ca*OH^2
5 Ksp=PARM(2)
6 si_pp=log(IAP/Ksp)
20  IF (M <= 0  and si_pp < 0) THEN GOTO 200
120 rate = PARM(1) *M* (1 - 10^(si_pp))
140 moles = rate*TIME
200 SAVE moles
   -end
Calcite
-start
1   REM   PARM(1) = rate constant. Parm(2)=Ksp calcite
2 Ca=Act("Ca+2")
3 CO3=Act("CO3-2")
4 IAP=Ca*CO3
5 Ksp=PARM(2)
6 si_cc=log(IAP/Ksp)
20  IF (M <= 0  and si_cc < 0) THEN GOTO 200
120 rate = PARM(1) *M* (1 - 10^(si_cc))
140 moles = rate*TIME
200 SAVE moles
   -end
CO2_dissolution
-start
20 k = parm(2)
30 eq_HCO3 = 10^PARM(1)*10^LK_PHASE("CO2(g)")/ACT("H+")
40 act_HCO3 = ACT("HCO3-")
50 moles = k * (1-(act_HCO3/eq_HCO3)) * TIME
60 SAVE moles
   -end

KINETICS 1
Portlandite
  -tol   1e-13
  -m0    0.08
  -m    0.08
  -parms 0.8 3.8607e-05
Calcite
  -tol   1e-13
  -m0    1e-06
  -m    1e-06
  -parms 1e-07 3.3113e-09
CO2_dissolution
  -tol   1e-13
-formula CO2 1
  -parms -3.5 5.05e-08
 -steps 0 1.25892541179417 1.28824955169313 1.31825673855641 1.34896288259165 1.38038426460288 1.41253754462275 1.44543977074593 1.47910838816821 1.51356124843621 1.54881661891248 1.58489319246111 1.62181009735893 1.65958690743756 1.69824365246174 1.73780082874938 1.77827941003892 1.81970085860998 1.86208713666287 1.90546071796325 1.94984459975805 1.99526231496888 2.04173794466953 2.08929613085404 2.13796208950223 2.18776162394955 2.23872113856834 2.29086765276777 2.34422881531992 2.39883291901949 2.45470891568503 2.51188643150958 2.57039578276886 2.63026799189538 2.69153480392692 2.75422870333817 2.81838293126445 2.88403150312661 2.95120922666639 3.01995172040202 3.09029543251359 3.16227766016838 3.23593656929628 3.31131121482591 3.38844156139203 3.46736850452532 3.54813389233576 3.63078054770101 3.71535229097173 3.80189396320561 3.89045144994281 3.98107170553497 4.07380277804113 4.16869383470335 4.26579518801593 4.36515832240166 4.46683592150963 4.57088189614875 4.67735141287198 4.78630092322638 4.89778819368446 5.01187233627272 5.12861383991365 5.24807460249773 5.37031796370253 5.49540873857625 5.62341325190349 5.75439937337157 5.88843655355589 6.02559586074358 6.16595001861482 6.30957344480193 6.45654229034655 6.60693448007596 6.76082975391982 6.91830970918936 7.07945784384138 7.2443596007499 7.41310241300917 7.58577575029184 7.76247116628692 7.94328234724282 8.12830516164099 8.31763771102671 8.51138038202377 8.7096358995608 8.91250938133745 9.1201083935591 9.33254300796991 9.54992586021436 9.77237220955811 10 10.2329299228075 10.471285480509 10.7151930523761 10.9647819614319 11.2201845430196 11.4815362149688 11.7489755493953 12.0226443461741 12.3026877081238 12.5892541179417 12.8824955169313 13.1825673855641 13.4896288259165 13.8038426460289 14.1253754462275 14.4543977074593 14.7910838816821 15.1356124843621 15.4881661891248 15.8489319246111 16.2181009735893 16.5958690743756 16.9824365246175 17.3780082874938 17.7827941003892 18.1970085860998 18.6208713666287 19.0546071796325 19.4984459975805 19.9526231496888 20.4173794466953 20.8929613085404 21.3796208950223 21.8776162394955 22.3872113856834 22.9086765276777 23.4422881531992 23.9883291901949 24.5470891568503 25.1188643150958 25.7039578276886 26.3026799189538 26.9153480392692 27.5422870333817 28.1838293126446 28.8403150312661 29.5120922666639 30.1995172040202 30.9029543251359 31.6227766016838 s
  -cvode
-runge_kutta      6

 SELECTED_OUTPUT
 -file portout.txt
 -selected_out true
 -user_punch true
 -high_precision true
 -reset false
 -simulation false
 -state false
 -distance false
 -time false
 -step false
 -ph false
 -pe false
 -reaction false
 -temperature false
 -alkalinity false
 -ionic_strength false
 -water false
 -charge_balance false
 -percent_error false

USER_PUNCH
        -headings seconds  Ca  pH Calcite  Portlandite 
  10 PUNCH SIM_TIME, TOT("Ca"), -LA("H+"), KIN("Calcite"), KIN("Portlandite") 

END